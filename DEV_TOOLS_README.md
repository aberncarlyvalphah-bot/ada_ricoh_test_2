# Data Ada Agent - 开发工具使用指南

本文档介绍如何使用自动化开发工具集，让 AI 帮助你自动开发、测试和迭代项目。

---

## 📁 文件说明

| 文件 | 说明 |
|------|------|
| `CLAUDE.md` | Agent 工作流指南，定义了每个会话必须遵循的步骤 |
| `task.json` | 任务列表，定义了所有待开发的功能（每个任务包含标题、描述、具体步骤） |
| `progress.txt` | 进度日志，记录每次会话完成的工作和测试结果 |
| `init.sh` | 环境初始化脚本，自动安装依赖并启动开发服务器 |
| `run-automation.sh` | 自动化脚本，让 AI 循环完成多个任务 |
| `screenshot.js` | 截图自动化脚本，使用 Puppeteer 捕获页面截图 |

---

## 🚀 快速开始

### 方式一：手动会话（推荐用于新手）

```bash
# 1. 初始化环境
./init.sh

# 2. 手动启动 Claude Code
# 然后告诉 AI："请按照 CLAUDE.md 的工作流程完成下一个任务"
```

### 方式二：自动循环执行（推荐）

```bash
# 运行自动化脚本，指定执行次数
./run-automation.sh 5  # 运行 5 次循环
```

**注意**：自动模式最危险，容易浪费资源，仅在了解后果后使用。

---

## 📋 工作流程详解

每个会话必须遵循以下步骤：

### Step 1: 初始化环境
```bash
./init.sh
```
这会：
- 检查依赖是否已安装
- 启动开发服务器（如果未运行）
- 确保服务器在 localhost:3000 正常运行

### Step 2: 选择下一个任务
AI 会自动读取 `task.json` 并选择一个 `passes: false` 的任务。

选择优先级：
1. `passes: false` 的任务优先
2. 考虑依赖关系（基础功能优先）
3. 选择最高优先级的未完成任务

### Step 3: 实现任务
AI 会：
- 仔细阅读任务描述和步骤
- 按照所有步骤实现功能
- 遵循现有代码模式和约定

### Step 4: 测试验证

**测试要求（必须）：**

1. **大幅度页面修改**：
   - 必须在浏览器中测试！
   - 使用 `node screenshot.js` 截图验证
   - 验证页面能正确加载和渲染
   - 验证交互功能（按钮点击、表单提交等）

2. **小幅度代码修改**：
   - 运行 `npm run lint` 检查代码规范
   - 运行 `npm run build` 确保构建成功
   - 如有疑虑，仍建议浏览器测试

3. **测试清单**：
   - [ ] 代码没有 TypeScript 错误
   - [ ] lint 通过
   - [ ] build 成功
   - [ ] 功能在浏览器中正常工作

### Step 5: 更新进度

AI 会将工作记录到 `progress.txt`：

```
## [Date] - Task: [task description]

### What was done:
- [具体做了什么]

### Testing:
- [如何测试的]

### Notes:
- [给下个会话的提示]
```

### Step 6: 提交更改

**重要**：所有更改必须在同一个 commit 中提交，包括 task.json 的更新！

流程：
1. 更新 `task.json`，将 `passes` 从 `false` 改为 `true`
2. 更新 `progress.txt` 记录工作内容
3. 一次性提交所有更改：

```bash
git add .
git commit -m "[task description] - completed"
```

**规则**：
- 只有在所有步骤都验证通过后才标记 `passes: true`
- 永远不要删除或修改任务描述
- 永远不要从列表中移除任务
- **一个 task 的所有内容（代码、progress.txt、task.json）必须在同一个 commit 中提交**

---

## 🚫 阻塞处理

如果任务无法完成测试或需要人工介入，必须遵循以下规则：

### 需要停止任务并请求人工帮助的情况：
1. **缺少环境配置**：需要真实的 API 密钥
2. **外部依赖不可用**：第三方 API 服务宕机
3. **测试无法进行**：功能依赖外部系统尚未部署

### 阻塞时的正确操作：

**禁止：**
- ❌ 提交 git commit
- ❌ 将 task.json 的 passes 设为 true
- ❌ 假装任务已完成

**必须：**
- ✅ 在 progress.txt 中记录当前进度和阻塞原因
- ✅ 输出清晰的阻塞信息
- ✅ 停止任务，等待人工介入

### 阻塞信息格式：

```
🚫 任务阻塞 - 需要人工介入

**当前任务**: [任务名称]

**已完成的工作**:
- [已完成的代码/配置]

**阻塞原因**:
- [具体说明为什么无法继续]

**需要人工帮助**:
1. [具体的步骤]
2. [具体的步骤]

**解除阻塞后**:
- 运行 [命令] 继续任务
```

---

## 📊 当前任务状态

查看 `task.json` 了解当前待完成的任务：

```bash
# 查看所有任务
cat task.json | grep -A 5 '"id": '

# 查看未完成的任务
cat task.json | grep -B 5 '"passes": false'
```

### 已完成任务 (passes: true)
1. ✅ 项目基础设施验证
2. ✅ 修复 Sidebar 导航路径
3. ✅ 修复 CanvasPanel 视觉问题
4. ✅ 修复 ChatInput 输入框大小

### 待完成任务 (passes: false)
5. ⏳ 项目结构优化
6. ⏳ 添加数据文件上传功能
7. ⏳ 实现数据预览功能
8. ⏳ 添加图表类型扩展
9. ⏳ 实现 AI 对话功能
10. ⏳ 实现项目持久化
11. ⏳ 响应式设计优化
12. ⏳ 添加主题切换功能
13. ⏳ 添加错误处理和加载状态
14. ⏳ 性能优化
15. ⏳ 添加无障碍支持
16. ⏳ 集成后端 API
17. ⏳ 添加数据导出功能
18. ⏳ 最终测试和部署准备

---

## 🔧 开发命令

```bash
# 在 data-ada-agent/ 目录下
npm run dev      # 启动开发服务器
npm run build    # 生产构建
npm run lint     # 运行 linter

# 截图验证
node screenshot.js  # 截图当前页面

# 自动化开发
./run-automation.sh 5  # 运行 5 次循环
```

---

## 📖 工作流理念

这套工具集基于以下原则设计：

1. **人类控制 AI**：不是 AI 替代程序员，而是如何更好地控制 AI
2. **逐步验证**：每一步都需要测试验证，通过后才能继续
3. **清晰追踪**：task.json 和 progress.txt 提供了完整的进度追踪
4. **原子提交**：每个任务一个 commit，方便回滚和审查
5. **人工介入**：遇到阻塞时停止，等待人工介入，不假装完成

---

## 💡 最佳实践

1. **开始新会话前**：运行 `./init.sh` 确保环境就绪
2. **检查进度**：查看 `progress.txt` 了解之前的工作
3. **理解任务**：仔细阅读 task.json 中的步骤描述
4. **测试驱动**：实现功能后立即测试，不要等到最后
5. **记录决策**：在 progress.txt 中记录重要的设计决策
6. **保持简洁**：每个会话专注一个任务，不要贪多

---

## 🎯 目标

这套工具的目的是帮助你：
- ✅ 自动化重复的开发工作
- ✅ 系统化地追踪开发进度
- ✅ 确保每一步都经过测试验证
- ✅ 让 AI 更好地理解项目状态
- ✅ 提供完整的开发历史记录

通过这套工具，你可以让 AI 帮助你高效地完成项目，同时保持对开发过程的完全控制。
